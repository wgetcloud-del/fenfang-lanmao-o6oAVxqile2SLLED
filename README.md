
公司产品基于Win11 23H2镜像版本制作母盘，我们发现随着版本迭代，基于上一版本母盘生成新母盘备份，母盘文件会越来越大。


此处说明下镜像与母盘文件的区别，


1\. 镜像是指操作系统的压缩文件，原始安装文件是ISO，常见压缩格式是WIM、ESD，有灵活的安装部署选项。


2\. 母盘文件是指在某个计算机上已经安装、配置好的操作系统副本，带分区、磁盘信息。母盘文件是备份硬盘上的内容，压缩到本地生成的备份文件，然后已经备份的母盘文件可以还原到其它硬盘上，也就是将文件或数据从一个位置搬到另外一个位置


当前制作的是双系统母盘，安卓\+Windows，制作流程是先刷安卓然后以其它启动盘安装Windows。


如果后续安卓和Windows有更新，则基于之前母盘备份版本，分别进入相应系统完成软件更新，再备份保存为新母盘文件。


最近几个月做的母盘，发现版本文件大小变大了：


![](https://img2024.cnblogs.com/blog/685541/202410/685541-20241030091558577-624435761.png)


### Windows系统备份分区优化


我们尝试先减少windows模块大小：


1\. 使用Dism清理冗余组件使用数据


![](https://img2024.cnblogs.com/blog/685541/202410/685541-20241028193655188-2145389601.png)


清理完后，公司大屏C盘大小几乎未减少。此硬盘因为并没有实际使用。


我试了家里个人电脑，清理后可以减少2\.5G：


![](https://img2024.cnblogs.com/blog/685541/202410/685541-20241031211552838-377652955.png)


 2\. 使用SDelete将空闲空间清理


下载[SDelete \- Sysinternals \| Microsoft Learn](https://github.com)，里面有可执行exe：


![](https://img2024.cnblogs.com/blog/685541/202410/685541-20241031141357944-527875311.png)


解压后使用命令行在目录中执行 “sdelete \-z C:"


![](https://img2024.cnblogs.com/blog/685541/202410/685541-20241031141559152-1593672327.png)





这个很有效，对空闲空间整理后，C盘减少了3G！


它能安全地清理磁盘可用空间


3\. 使用系统工具\-磁盘清理
直接搜索磁盘清理工具，打开后可以看到待清理的文件如回收站、浏览器临时文件等，点击确定



![](https://img2024.cnblogs.com/blog/685541/202410/685541-20241029202758673-1002264656.png)


![](https://img2024.cnblogs.com/blog/685541/202410/685541-20241029202955754-1798056684.png)


这里可以看到因为是母盘刚还原的系统，未有频繁使用，所以没有很多优化空间


所以Windows端通过SDelete优化3G，因Windows加了备份还原，所以总共可以减少6G。


### 安卓系统分区大小优化


再看安卓端，对比前后母盘版本中安卓分区备份文件大小，A03\-\>A05：


![](https://img2024.cnblogs.com/blog/685541/202410/685541-20241031213659065-639612785.png)


看到p10分区变大了6倍。。。安卓系统分区很多，p10是其中一个分区


与之前负责母盘的同事沟通，应该是有进入安卓端更新了软件。基于之前母盘，进入安卓端使用OTA文件更新软件版本，生成新母盘版本。


后来验证，除了更新安卓OTA，应该是只要启动进入过安卓系统，也会增加分区备份文件大小。


所以安卓端如果要保持较小的备份大小，做母盘应该根据镜像重新制作。


 


 



 



 本博客参考[milou加速器](https://jiechuangmoxing.com)。转载请注明出处！
